entities:
  # disabled old K8s service schema (moved to seaf-core)
  seaf.ta.services.k8s_disabled:
    schema:
      $defs:
        seaf.ta.services.k8s_dzo:
          title: Расширение описание кластера K8s для ДЗО
          type: object
          properties:
            #Часть 3. TACIR_1-КП-КО-3-01. Платформа контейнерной оркестрации должна иметь в резервных зонах доступности кластер/кластеры обеспечивающие 100% производительности платформы при потере основной зоны.
            reservation_rate:
              title: Процент резервирования вычислительных ресурсов кластера в другой зоне доступности
              type: integer
            #Часть 3. TACIR_1-КП-КБ-2-01.
            ntp_server:
              title: Адрес NTP сервера с которым синхронизируются все ноды кластера
              type: string
            #Часть 3. TACIR_1-КП-КБ-8-01.
            tls_version:
              title: Версия TLS сертификатов кластера (kubeapi, etc...).
              type: string
            #Часть 3. TACIR_1-КП-КБ-16-01
            anonymous_api_connect:
              title: Анонимное подключение к kubeapi включено
              type: boolean
            #Часть 3. TACIR_1-КП-КБ-18-01.
            https_api_connect:
              title: HTTPS подключение к kubeapi включено
              type: boolean
            #Часть 3. TACIR_1-КП-КБ-29-01.
            pv:
              title: Persistent Volume используются в кластере K8s
              type: boolean
            virtual_cluster:
              title: Связь K8s кластера с кластером виртуализации
              type: string
            class:
              title: Класс систем
              enum:
                - Контейнеризация
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
          required:
            - reservation_rate
            - ntp_server
            - tls_version
            - anonymous_api_connect
            - https_api_connect
            - pv
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.services.k8s_dzo"

  seaf.ta.components.server:
    schema:
      $defs:
        seaf.ta.components.server_dzo:
          title: Расширение описания физических серверов для целей проверки станадртов
          type: object
          properties:
            #Часть 3. TACIR_1-Ч03.02.4-02.
            power_module_qty:
              title: Количество блоков питания
              type: integer
            #Часть 3. TACIR_1-Ч03.02.4-02.
            fan_qty:
              title: Количество кулеров
              type: integer
            #Часть 3. TACIR_1-Ч03.02.4-02.
            raid_level:
              title: Уровени RAID применённые на сервере
              type: array
            #Часть 3. TACIR_1-Ч03.02.5-02.
            raid_spare_disks:
              title: Количество запасных дисков для RAID массивов
              type: integer
            #Часть 3. TACIR_1-Ч03.02.6-02.
            rack_mount:
              title: Стоечное исполнение сервера
              type: boolean
          required:
            - power_module_qty
            - fan_qty
            - raid_level
            - raid_spare_disks
            - rack_mount
      patternProperties:
        "^[a-zA-Z0-9_-]*(\\.[a-zA-Z0-9_-]*)*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.components.server_dzo"

  seaf.ta.components.hw_storage:
    schema:
      $defs:
        seaf.ta.components.hw_storage_dzo:
          title: Расширение описания физической СХД для целей проверки станадртов
          type: object
          properties:
            #Часть 4. TACIR_2-Ч04.01.3-01.
            nvram_amount:
              title: Объям NVRAM, Gb
              type: integer
            #Часть 4. TACIR_2-Ч04.01.4-01
            dedup_rate:
              title: Коэффициент дедупликации
              type: integer
            #Часть 4. TACIR_2-Ч04.01.4-01
            compression_rate:
              title: Коэффициент компрессии
              type: integer
            #Часть 4. TACIR_2-Ч04.01.5-01
            ssd_cache_qty:
              title: Количество SSD дисков для кеша
              type: integer
            #Часть 4. TACIR_2-Ч04.01.6-01
            ntp_server:
              title: Адрес NTP сервера с которым синхронизируется СХД
              type: string
            #Часть 4. TACIR_2-Ч04.01.7-01
            storage_console:
              title: Адрес консоли управления СХД
              type: string
            #Часть 4. TACIR_2-Ч04.01.11-02
            snapshot_lic:
              title: Наличие лицензии snapshot\snapclone
              type: boolean
            #Часть 4. TACIR_2-Ч04.01.12.1-03
            storage_controller_qty:
              title: Количество контроллеров СХД
              type: integer
            #Часть 4. TACIR_2-Ч04.01.12.1-03
            storage_spare_disk_qty:
              title: Количество запасных дисков в СХД
              type: integer
            #Часть 4. TACIR_2-Ч04.01.12.1-03
            pwr_supply_qty:
              title: Количество блоков питания
              type: integer
            #Часть 4. TACIR_2-Ч04.01.12.2-03
            links_qty:
              title: Количество SAN\LAN подключений для каждого контроллера
              type: integer
            #Часть 4. TACIR_2-Ч04.01.15-02
            reservation_ratio:
              title: % резервирования объёма в другом ЦОДе
              type: integer
            #Часть 4. TACIR_2-Ч04.01.4-01
            erasure_coding:
              title: Параметр чётности
              type: integer
          required:
            - nvram_amount
            - dedup_rate
            - compression_rate
            - ssd_cache_qty
            - ntp_server
            - storage_console
            - snapshot_lic
            - storage_controller_qty
            - storage_spare_disk_qty
            - pwr_supply_qty
            - links_qty
            - reservation_ratio
            - erasure_coding
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.components.hw_storage_dzo"

  seaf.ta.services.monitoring:
    schema:
      $defs:
        seaf.ta.services.monitoring_dzo:
          title: Расширение описания сервиса мониторинга для целей проверки станадртов
          type: object
          properties:
            #Часть 6. TACMN_1-Ч06.01.4-02.
            monitoring_console:
              title: Адрес веб-консоли системы мониторинга
              type: string
            #Часть 6. TACMN_1-Ч06.01.7-02.
            cluster:
              title: ID кластера мониторинга
              type: string
            #Часть 6. TACMN_1-Ч06.01.5-02.
            alarm_transport:
              title: Перечисление транспортов для доставки уведомлений системы мониторинга (почта, телеграм, смс и т.д.)
              type: array
            #Часть 6. TACMN_1-Ч06.01.13-02.
            sber_radar:
              title: Адрес дашборда СберРадара
              type: string
            #Часть 6. TACMN_1-Ч06.01.13-02 и ещё 3 номера
            history:   #todo добавить проверку. Если history менее 1 года для инфра, 45 для журналирования, 1 месяц для прикладного, 7 дней для трейсинга, то несоответствие
              title: Длительность хранения метрик в днях
              type: integer
            #Часть 6. TACMN_1-Ч06.02.6-01 и ещё 1 номер
            frequency:   #todo добавить проверку. Если frequency более 60 секунд для инфра, 60 секунд  для прикладного, то несоответствие
              title: Частота сбора метрик в секундах
              type: integer
            #Часть 6. TACMN_1-Ч06.05.1-01
            pam_anabled:
              title: Система мониторинга подключена к PAM (priveled access management) системе
              type: boolean
            #Часть 6. TACMN_1-Ч06.05.3-01
            siem_anabled:
              title: Система мониторинга подключена к SIEM системе
              type: boolean
            class:
              title: Класс систем
              enum:
                - Логгирование
                - Мониторинг
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
          required:
            - monitoring_console
            - alarm_transport
            - sber_radar
            - history
            - frequency
            - pam_anabled
            - siem_anabled
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.services.monitoring_dzo"

  seaf.ta.components.network:
    schema:
      $defs:
        seaf.ta.components.network_dzo:
          title: Расширение описания сетевых устройств для целей проверки станадртов
          type: object
          properties:
            class:
              title: Класс систем
              enum:
                - Удаленный доступ
                - Proxy-серверы
                - Web-серверы
                - Балансировка нагрузки (load balancers)
                - Иное
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
            device_type:
              title: Тип сетевого устройства
              enum:
                - Маршрутизатор (роутер)
                - Коммутатор (свитч)
                - Точка доступа (Wi-Fi)
                - Межсетевой экран (файрвол)
                - Web Application Firewall
                - Сетевой концентратор (хаб)
                - Повторитель (репитер)
                - Балансировщик нагрузки (Load Balancer)
                - Анализатор трафика (сетевой анализатор)
                - VoIP-шлюз
            auth_type:
              title: Тип аутентификации
              enum:
              - Отсутствует
              - Пароль и логин
              - Сертификат
              - Двухфакторная
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.components.network_dzo"

  seaf.ta.services.cluster:
    schema:
      $defs:
        seaf.ta.services.cluster_dzo:
          title: Расширение описания Cluster для совместимости с КА ДЗО
          type: object
          properties:
            class:
              title: Класс систем
              enum:
                - Архитектурный репозиторий
                - Бекапирование и восстановление данных
                - Виртуализация
                - Контейнеризация
                - Логгирование
                - Мониторинг
                - Удаленный доступ
                - Управление конфигурациями
                - Управление облачной инфраструктурой
                - BigData
                - CDC (Change Data Capture)
                - DWH (Хранилище данных)
                - ETL
                - FTP/SFTP/FTPS серверы
                - MDM (Master Data Management)
                - Message Queue
                - NoSQL СУБД
                - OLAP & BI
                - Proxy-серверы
                - Web-серверы
                - Балансировка нагрузки (load balancers)
                - Интеграционная шина
                - Каналы обслуживания клиентов (фронтальные решения)
                - Проверка и очистка данных
                - Распределенный кэш
                - Реляционные СУБД
                - Серверы приложений (Application Servers)
                - Файловое хранилище
                - Иное
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
            comments:
              title: Комментарии, риски, проблемы
              type: array
              items:
                type: string
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.services.cluster_dzo"

  seaf.ta.services.compute_service:
    schema:
      $defs:
        seaf.ta.services.compute_service_dzo:
          title: Расширение описания Compute Service для совместимости с КА ДЗО
          type: object
          properties:
            class:
              title: Класс систем
              enum:
                - Архитектурный репозиторий
                - Бекапирование и восстановление данных
                - Виртуализация
                - Контейнеризация
                - Логгирование
                - Мониторинг
                - Удаленный доступ
                - Управление конфигурациями
                - Управление облачной инфраструктурой
                - BigData
                - CDC (Change Data Capture)
                - DWH (Хранилище данных)
                - ETL
                - FTP/SFTP/FTPS серверы
                - MDM (Master Data Management)
                - Message Queue
                - NoSQL СУБД
                - OLAP & BI
                - Proxy-серверы
                - Web-серверы
                - Балансировка нагрузки (load balancers)
                - Интеграционная шина
                - Каналы обслуживания клиентов (фронтальные решения)
                - Проверка и очистка данных
                - Распределенный кэш
                - Реляционные СУБД
                - Серверы приложений (Application Servers)
                - Файловое хранилище
                - Иное
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
               $ref: "#/$defs/seaf.ta.services.compute_service_dzo"

  seaf.ta.services.backup:
    schema:
      $defs:
        seaf.ta.services.backup_dzo:
          title: Расширение описания backup для совместимости с КА ДЗО
          type: object
          properties:
            class:
              title: Класс систем
              enum:
                - Бекапирование и восстановление данных
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.services.backup_dzo"

  seaf.ta.services.cluster_virtualization:
    schema:
      $defs:
        seaf.ta.services.cluster_virtualization_dzo:
          title: Расширение описания кластера виртуализации для совместимости с КА ДЗО
          type: object
          properties:
            class:
              title: Класс систем
              enum:
                - Виртуализация
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.services.cluster_virtualization_dzo"

  seaf.ta.services.storage:
    schema:
      $defs:
        seaf.ta.services.storage_dzo:
          title: Расширение описания Storage для совместимости с КА ДЗО
          type: object
          properties:
            class:
              title: Класс систем
              enum:
                - DWH (Хранилище данных)
                - FTP/SFTP/FTPS серверы
                - Файловое хранилище
                - Иное
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.services.storage_dzo"

  seaf.ta.services.dc:
    schema:
      $defs:
        seaf.ta.services.dc_dzo:
          title: Расширение описания Datacenter для совместимости с КА ДЗО
          type: object
          properties:
            class:
              title: Класс систем
              enum:
                - Иное
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.services.dc_dzo"

  seaf.ta.services.dc_az:
    schema:
      $defs:
        seaf.ta.services.dc_az_dzo:
          title: Расширение описания Datacenter для совместимости с КА ДЗО
          type: object
          properties:
            class:
              title: Класс систем
              enum:
                - Иное
            location:
              title: Размещение
              enum:
                - Внешняя
                - Внутренняя
            status:
              title: Статус
              enum:
                - Создается
                - Используется
                - Выводится
                - В архиве
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.services.dc_dzo"

  seaf.ta.services.network_segment:
    schema:
      $defs:
        seaf.ta.services.network_segment_dzo:
          title: Расширение описания Network Segment для Р41
          type: object
          properties:
            location:
              title: ID ЦОД или Офиса
              anyOf:
                - $ref: "#/$rels/seaf.ta.services.dc.dc"
                - $ref: "#/$rels/seaf.ta.services.office.office"
            zone:
              title: Сетевая зона
              enum:
                - EXTERNAL-NET
                - INTERNET
                - TRANSPORT-WAN
                - INET-EDGE
                - EXT-WAN-EDGE
                - INT-WAN-EDGE
                - DMZ
                - INT-NET
                - INT-SECURITY-NET
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          type: object
          properties:
            sber:
              $ref: "#/$defs/seaf.ta.services.network_segment_dzo"

  seaf.ta.services.kb:
    title: Сервис кибер безопасности
    objects:
      kb:
        route: "/"
        title: Сервис кибер безопасности
    schema:
      type: object
      patternProperties:
        "^[a-zA-Z0-9_\\.]*$":
          $ref: "#/$defs/seaf.ta.services.base.entity"
          oneOf:
            # ИБ-Антивирусное ПО
            - type: object
              title: ИБ-Антивирусное ПО
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Потоковый антивирус]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [AV]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Аудит действий персонала
            - type: object
              title: ИБ-Аудит действий персонала
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Мониторинг действий пользователей]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [UAM]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Защита от киберугроз (Sandbox + SCAN)
            - type: object
              title: ИБ-Защита от киберугроз
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Динамический анализ угроз Sandbox, Инструментальный контроль защищенности]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [Sandbox, SCAN]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Управление доступом
            - type: object
              title: ИБ-Управление доступом
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Межсетевое экранирование, Управление доступом пользователей, Контроль подключений к сети, Контентная фильтрация и разграничение доступа в Интернет]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [FW, IDFW, NAC, Proxy]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Защита трафика
            - type: object
              title: ИБ-Защита трафика
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Сигнатурный анализ режим обнаружения вторжений, Сигнатурный анализ режим предотвращения вторжений, Поведенческий анализ сетевого трафика]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [IDS, IPS, NBA]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Защита от сетевых атак
            - type: object
              title: ИБ-Защита от сетевых атак
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Защита от атак типа "Отказ от обслуживания", Защита веб-приложений WAF, Шлюзы безопасности прикладного уровня]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [DDoS, WAF, ALG]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Защита от утечек информации
            - type: object
              title: ИБ-Защита от утечек информации
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Защита от утечек информации]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [DLP]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Управление событиями инф.безопасности
            - type: object
              title: ИБ-Управление событиями инф.безопасности
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Аудит событий КБ]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [Log]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Управление оборудованием
            - type: object
              title: ИБ-Управление оборудованием
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Безопасность конфигураций]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [CS]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Управление сертификатами
            - type: object
              title: ИБ-Управление сертификатами
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Центр управления сертификатами ИБ]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [CMC]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
            # ИБ-Предотвращение мошенничества
            - type: object
              title: ИБ-Предотвращение мошенничества
              required: [technology, software_name, label, status, network_connection]
              properties:
                technology:
                  type: string
                  enum: [Защита от мошеннических операций]
                software_name:
                  type: string
                label:
                  type: string
                  enum: [AntiFraud]
                status:
                  title: Статус
                  type: string
                  enum:
                    - Создается
                    - Используется
                    - Выводится
                    - В архиве
                network_connection:
                  title: Перечисление связанных сетей
                  type: array
                  items:
                    $ref: "#/$rels/seaf.ta.services.network.network"
              additionalProperties: false
